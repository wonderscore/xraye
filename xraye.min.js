/* ==========================================================
 * x r a y e
 * Annotate sizing and spacing of HTML elements
 * v0.8.2
 *
 * https://github.com/wonderscore/xraye
 *
 * Author: Danny Allen (me@dannya.com)
 * Author: Wonderscore Ltd (wonderscore.co.uk)
 *
 * Copyright 2017 Danny Allen & Wonderscore Ltd
 * Licensed under MIT
 ========================================================== */
!function(t,a,n,e){var o={active:!0,showSizing:!0,showSpacing:!0,showFontSizing:!0,displayUnitsPixels:!0,displayUnitsPercent:!0,showPropertyNames:!0,pointerTransparency:!1,exclude:"",excludeChildrenOf:"",valueAnnotationThreshold:10,controlIcon:{position:"left",offset:"-48px"},annotationColors:{sizing:{line:"red",box:"red",arrow:"red",text:"white","line:hover":"red","box:hover":"red","arrow:hover":"red","text:hover":"white"},spacing:{line:"green",box:"green",arrow:"green",text:"white","line:hover":"green","box:hover":"green","arrow:hover":"green","text:hover":"white"},fontSizing:{line:"blue",box:"blue",arrow:"blue",text:"white","line:hover":"blue","box:hover":"blue","arrow:hover":"blue","text:hover":"white"}},levelColors:{1:"blue",2:"red",3:"yellow",4:"orange",5:"green",6:"purple",7:"pink",8:"brown",9:"beige"}},i=function(n,e){if(this.element=n,this.options=t.extend({},o,e),this._defaults=o,this._name="xraye",this.id=this.getRandomId(),this.annotationPropertyMapping={sizing:["width","height"],spacing:["paddingTop","paddingBottom","paddingLeft","paddingRight","marginTop","marginBottom","marginLeft","marginRight"],fontSizing:["fontSize"]},this.elementData={},this.styles={},this.canvasStyles={},this.levelColors=this.options.levelColors||{},this.initialStyles="@keyframes xraye-attention { 50% { padding: 3px 5px 5px 5px; } }",this.$element=t(this.element),this.$insertionElement=t("body"),this.$container=t('<div data-xraye="'+this.id+'" data-xraye-container />'),this.$styles=t("<style data-xraye-styles />"),this.$canvasStyles=t('<style data-xraye-styles="canvas" />'),this.$canvas=t('<div data-xraye="'+this.id+'" data-xraye-canvas />'),this.$controlPanel=t("<div data-xraye-controlpanel />"),this.$icon=t('<svg data-xraye-controlicon xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 24 24" width="48" height="48" viewBox="0 0 12.7 12.7"><path d="M 2.1895215,-1.1e-4 6.78774e-7,2.18941 0.74872076,2.93813 2.9382416,0.74861 Z m 1.1228974,1.1229 -2.1895208,2.18952 9.0135079,9.01351 2.189521,-2.18952 z M 12.700104,10.51048 10.511309,12.7 h 2.188792 z"/><path d="M 6.7245952,3.78588 8.9141171,5.9754 12.700104,2.18941 10.510582,-1.1e-4 9.7622282,0.74824 10.856623,1.84264 10.482446,2.21682 9.3880509,1.12242 8.6396962,1.87077 9.7340917,2.96517 9.3599144,3.33935 8.2655189,2.24495 7.5171642,2.99331 8.6115597,4.0877 8.2373824,4.46188 7.1429869,3.36748 Z"/><path d="M 1.1225318,9.38721 2.2172929,10.48197 1.8431156,10.85615 0.74872008,9.76175 0,10.51047 2.1895218,12.69999 5.975875,8.91437 3.785622,6.72412 3.3675957,7.14214 4.4623569,8.2369 4.0881795,8.61108 2.9934184,7.51632 2.2450638,8.26468 3.3398249,9.35944 2.9656476,9.73361 1.8708865,8.63885 Z"/></svg>'),"function"==typeof this.options.canInit)var i=this,s=a.setInterval(function(){i.options.canInit()&&(a.clearInterval(s),i.init())},this.options.canInitInterval?this.options.canInitInterval:500);else this.init()};i.prototype={init:function(){this.elementData=this.getElementData(this.$element),this.styles["&"]={position:"absolute",left:this.elementData.left+"px",top:this.elementData.top+"px",width:this.elementData.width+"px",height:this.elementData.height+"px"},this.$insertionElement.css("overflow","hidden"),this.renderElement([this.$styles,this.$canvasStyles],this.$container),this.renderElement([this.$container,this.$canvas],this.$insertionElement),this.drawControlPanel(),this.updateStyles(this.initialStyles+this.stringifyStyles(this.styles)),this.clearCanvas(),this.options.active&&this.drawAnnotations(),this.updateCanvasStyles(this.stringifyStyles(this.canvasStyles))},clearCanvas:function(){this.canvasStyles={},this.setSharedCanvasStyles(),this.$canvas.html("")},drawAnnotations:function(){if(!this.isExcluded(this.$element)&&!this.isExcludedChildren(this.$element)){var t=this.$element.children();t.length>0&&this.processElements(t,1)}},isExcluded:function(t){var a=!1;return"function"==typeof this.options.exclude?a=this.options.exclude(t):"string"==typeof this.options.exclude&&this.options.exclude.length>0&&(a=!t.is(this.options.exclude)),a},isExcludedChildren:function(t){var a=!1;return"function"==typeof this.options.excludeChildrenOf?a=this.options.excludeChildrenOf(t):"string"==typeof this.options.excludeChildrenOf&&this.options.excludeChildrenOf.length>0&&(a=!t.is(this.options.excludeChildrenOf)),a},setSharedCanvasStyles:function(){this.options.active&&!this.options.pointerTransparency||(this.canvasStyles["&[data-xraye-canvas]"]={"pointer-events":"none"}),this.canvasStyles["[data-xraye-arrow]"]=this.canvasStyles["[data-xraye-box]"]={position:"absolute",opacity:this.options.pointerTransparency?"1":"0.3","pointer-events":"none"},this.canvasStyles['[data-xraye-arrow-orientation="horizontal"]']={"text-align":"center","border-top":"2px solid"},this.canvasStyles['[data-xraye-arrow-orientation="horizontal"][data-xraye-annotation-type="sizing"]']={"border-top-color":this.options.annotationColors.sizing.line},this.canvasStyles['[data-xraye-arrow-orientation="horizontal"][data-xraye-annotation-type="spacing"]']={"border-top-color":this.options.annotationColors.spacing.line},this.canvasStyles['[data-xraye-arrow-orientation="horizontal"] span']={display:"inline-block","white-space":"nowrap",padding:"1px 3px 3px 3px","z-index":"10001",transform:"translate(-100%, -50%)"},this.canvasStyles['[data-xraye-arrow-orientation="horizontal"]:before']={content:'"\\25C0"',display:"inline-block",position:"absolute",left:"-2px",top:"-11px","font-size":"14px"},this.canvasStyles['[data-xraye-arrow-orientation="horizontal"][data-xraye-annotation-type="sizing"]:before']={color:this.options.annotationColors.sizing.arrow},this.canvasStyles['[data-xraye-arrow-orientation="horizontal"][data-xraye-annotation-type="spacing"]:before']={color:this.options.annotationColors.spacing.arrow},this.canvasStyles['[data-xraye-arrow-orientation="horizontal"]:after']={content:'"\\25B6"',display:"inline-block",position:"absolute",right:"-1px",top:"-11px","font-size":"14px"},this.canvasStyles['[data-xraye-arrow-orientation="horizontal"][data-xraye-annotation-type="sizing"]:after']={color:this.options.annotationColors.sizing.arrow},this.canvasStyles['[data-xraye-arrow-orientation="horizontal"][data-xraye-annotation-type="spacing"]:after']={color:this.options.annotationColors.spacing.arrow},this.canvasStyles['[data-xraye-arrow-orientation="vertical"]']={display:"flex","flex-direction":"column","justify-content":"center","border-left":"2px solid"},this.canvasStyles['[data-xraye-arrow-orientation="vertical"][data-xraye-annotation-type="sizing"]']={"border-left-color":this.options.annotationColors.sizing.line},this.canvasStyles['[data-xraye-arrow-orientation="vertical"][data-xraye-annotation-type="spacing"]']={"border-left-color":this.options.annotationColors.spacing.line},this.canvasStyles['[data-xraye-arrow-orientation="vertical"] span']={display:"inline-block","white-space":"nowrap",padding:"1px 3px 3px 3px","z-index":"10001",transform:"translate(-50%, 0)"},this.canvasStyles['[data-xraye-arrow-orientation="vertical"]:before']={content:'"\\25B2"',display:"inline-block",position:"absolute",left:"-8px",top:"-7px","font-size":"14px"},this.canvasStyles['[data-xraye-arrow-orientation="vertical"][data-xraye-annotation-type="sizing"]:before']={color:this.options.annotationColors.sizing.arrow},this.canvasStyles['[data-xraye-arrow-orientation="vertical"][data-xraye-annotation-type="spacing"]:before']={color:this.options.annotationColors.spacing.arrow},this.canvasStyles['[data-xraye-arrow-orientation="vertical"]:after']={content:'"\\25BC"',display:"inline-block",position:"absolute",left:"-8px",bottom:"-7px","font-size":"14px"},this.canvasStyles['[data-xraye-arrow-orientation="vertical"][data-xraye-annotation-type="sizing"]:after']={color:this.options.annotationColors.sizing.arrow},this.canvasStyles['[data-xraye-arrow-orientation="vertical"][data-xraye-annotation-type="spacing"]:after']={color:this.options.annotationColors.spacing.arrow},this.canvasStyles['[data-xraye-annotation-type="sizing"] span']={color:this.options.annotationColors.sizing.text,background:this.options.annotationColors.sizing.box},this.canvasStyles['[data-xraye-annotation-type="spacing"] span']={color:this.options.annotationColors.spacing.text,background:this.options.annotationColors.spacing.box},this.canvasStyles['[data-xraye-annotation-type="fontSizing"] span']={display:"inline-block","white-space":"nowrap",padding:"1px 3px 3px 3px","z-index":"10001",color:this.options.annotationColors.fontSizing.text,background:this.options.annotationColors.fontSizing.box}},drawControlPanel:function(){var a=this;this.renderElement([this.$icon,this.$controlPanel],this.$container),this.$controlPanel.append(t("<div />").append(t("<h1 />").append(this.drawCheckbox("active","xray elements")),t("<fieldset />").append(t("<legend />").text("Annotate"),this.drawCheckbox("showSizing","Sizing"),this.drawCheckbox("showSpacing","Spacing"),this.drawCheckbox("showFontSizing","Font size")),t("<fieldset />").append(t("<legend />").text("Display units"),this.drawCheckbox("displayUnitsPixels","Pixels (px)"),this.drawCheckbox("displayUnitsPercent","Percent (%)")),t("<fieldset />").append(t("<legend />").text("Other"),this.drawCheckbox("showPropertyNames","Show CSS property names"),this.drawCheckbox("pointerTransparency","Mouse pointer transparency")))),this.styles["[data-xraye-controlicon]"]={position:"absolute",top:"0",cursor:"pointer","z-index":"12000",transition:"transform 0.3s ease-in-out"},this.styles["[data-xraye-controlicon]"][this.options.controlIcon.position]=this.options.controlIcon.offset,this.styles["[data-xraye-controlicon]:hover path"]={fill:"red"},this.styles["&[data-xraye-container]"]={width:"0",transition:"width 0.5s ease-in-out"},this.styles["[data-xraye-controlpanel]"]={position:"absolute","min-height":"200px",left:"-10px",top:"-10px",bottom:"-10px",width:"0",padding:"18px 0",background:"rgba(0, 0, 0, 0.8)",color:"white","font-size":"16px","z-index":"11000","overflow-y":"auto",transition:"width 0.5s ease-in-out, padding 0.5s ease-in-out"},this.styles["[data-xraye-controlpanel] > div"]={opacity:"0",transition:"opacity 0.25s ease-in-out"},this.styles["[data-xraye-controlpanel] label"]={display:"block",cursor:"pointer"},this.styles["[data-xraye-controlpanel] label input"]={float:"left",margin:"7px 10px 0 4px"},this.styles["[data-xraye-controlpanel] h1"]={"font-family":"monospace","font-size":"20px"},this.styles["[data-xraye-controlpanel] h1 label input"]={"margin-top":"9px"},this.styles["[data-xraye-controlpanel] fieldset"]={"margin-top":"20px"},this.styles["[data-xraye-controlpanel] fieldset legend"]={padding:"0 10px 2px 10px",margin:"0 0 0 -20px"},this.styles["[data-xraye-controlpanel] #showSizing + span"]=this.styles["[data-xraye-controlpanel] #showSpacing + span"]=this.styles["[data-xraye-controlpanel] #showFontSizing + span"]={display:"inline-block","min-width":"200px"},this.styles["[data-xraye-controlpanel] #showSizing + span::after"]=this.styles["[data-xraye-controlpanel] #showSpacing + span::after"]=this.styles["[data-xraye-controlpanel] #showFontSizing + span::after"]={content:'""',display:"inline-block",float:"right",width:"16px",height:"16px",margin:"4px 0",border:"1px solid white"},this.styles["[data-xraye-controlpanel] #showSizing + span::after "]={background:this.options.annotationColors.sizing.box},this.styles["[data-xraye-controlpanel] #showSpacing + span::after "]={background:this.options.annotationColors.spacing.box},this.styles["[data-xraye-controlpanel] #showFontSizing + span::after "]={background:this.options.annotationColors.fontSizing.box},this.styles["&[data-xraye-container].xraye-controlpanel-visible [data-xraye-controlicon]"]={transform:"rotate(-45deg)"},this.styles["&[data-xraye-container].xraye-controlpanel-visible"]={width:this.$element.outerWidth()+20+"px"},this.styles["&[data-xraye-container].xraye-controlpanel-visible [data-xraye-controlpanel]"]={padding:"18px",width:this.$element.outerWidth()+20+"px"},this.styles["&[data-xraye-container].xraye-controlpanel-visible [data-xraye-controlpanel] > div"]={opacity:"1"},this.$icon.off("click.xraye-controlpanel").on("click.xraye-controlpanel",function(t){return t.preventDefault(),a.$container.toggleClass("xraye-controlpanel-visible"),!1})},drawCheckbox:function(a,n){var e=this;return t("<label />").append(t('<input type="checkbox" id="'+a+'"'+(this.options[a]?' checked="checked"':"")+" />").on("change",function(t){e.changeOption(this.id,this.checked)}),"<span>"+n+"</span>")},changeOption:function(t,a,n){this.options[t]=a,!1!==n&&(this.clearCanvas(),this.options.active&&(this.drawAnnotations(),this.updateCanvasStyles(this.stringifyStyles(this.canvasStyles))))},stringifyStyles:function(t){var a="";for(var n in t){a+='[data-xraye="'+this.id+'"]',"&"===n[0]?a+=n.substr(1)+" {":a+=" "+n+" {";for(var e in t[n])a+=e+": "+t[n][e]+";";a+="}\n"}return a},drawTextBox:function(a,n,e,o,i){var s;-1!==this.annotationPropertyMapping.sizing.indexOf(n)?s="sizing":-1!==this.annotationPropertyMapping.spacing.indexOf(n)?s="spacing":-1!==this.annotationPropertyMapping.fontSizing.indexOf(n)&&(s="fontSizing");var r='data-xraye-element="'+a+'"',l='data-xraye-box="'+a+"_"+n+'"',p='data-xraye-annotation-type="'+s+'"',h="["+l+"]";this.canvasStyles[h]={left:e-1+"px",top:o+"px"},this.renderElement(t("<div "+r+" "+l+" "+p+" />").append(t("<span />").text((this.options.showPropertyNames?n+" ":"")+i+"px")))},drawArrow:function(a,n,e,o,i,s){var r;-1!==this.annotationPropertyMapping.sizing.indexOf(n)?r="sizing":-1!==this.annotationPropertyMapping.spacing.indexOf(n)?r="spacing":-1!==this.annotationPropertyMapping.fontSizing.indexOf(n)&&(r="fontSizing");var l,p='data-xraye-element="'+a+'"',h='data-xraye-arrow="'+a+"_"+n+'"',d='data-xraye-annotation-type="'+r+'"',c="["+h+"]";!1===e?(l='data-xraye-arrow-orientation="vertical"',this.canvasStyles[c]={left:o-1+"px",top:i+"px",height:s+"px"}):(l='data-xraye-arrow-orientation="horizontal"',this.canvasStyles[c]={left:o+"px",top:i-2+"px",width:s+"px"});var y=[];this.options.displayUnitsPixels&&y.push(s+"px"),this.options.displayUnitsPercent&&(e?this.elementData.width>0&&y.push(Math.round(s/this.elementData.width*100)+"%"):this.elementData.height>0&&y.push(Math.round(s/this.elementData.height*100)+"%")),this.renderElement(t("<div "+p+" "+h+" "+l+" "+d+" />").append(t("<span />").text((this.options.showPropertyNames?n+" ":"")+y.join(" / "))))},drawElementMask:function(a,n,e,o,i,s){var r='data-xraye-element="'+a+'"',l='data-xraye-mask="'+a+'"',p='data-xraye-level="'+n+'"',h="["+l+"]";this.canvasStyles[h]={position:"absolute",left:e+"px",top:o+"px",width:i+"px",height:s+"px",outline:"1px dashed "+this.levelColors[n]},this.canvasStyles[h+":hover"]={"outline-style":"solid","background-color":"rgba(0, 0, 0, 0.2)","background-image":"repeating-linear-gradient(45deg, transparent, transparent 35px, rgba(255, 255, 255, 0.2) 35px, rgba(255, 255, 255, 0.2) 70px)"},this.canvasStyles[h+':hover ~ [data-xraye-element="'+a+'"][data-xraye-arrow]']=this.canvasStyles[h+':hover ~ [data-xraye-element="'+a+'"][data-xraye-box]']={opacity:"1","z-index":"10011"},this.canvasStyles[h+':hover ~ [data-xraye-element="'+a+'"][data-xraye-arrow-orientation="horizontal"][data-xraye-annotation-type="sizing"]']={"border-top-color":this.options.annotationColors.sizing["line:hover"]},this.canvasStyles[h+':hover ~ [data-xraye-element="'+a+'"][data-xraye-arrow-orientation="horizontal"][data-xraye-annotation-type="spacing"]']={"border-top-color":this.options.annotationColors.spacing["line:hover"]},this.canvasStyles[h+':hover ~ [data-xraye-element="'+a+'"][data-xraye-arrow-orientation="vertical"][data-xraye-annotation-type="sizing"]']={"border-left-color":this.options.annotationColors.sizing["line:hover"]},this.canvasStyles[h+':hover ~ [data-xraye-element="'+a+'"][data-xraye-arrow-orientation="vertical"][data-xraye-annotation-type="spacing"]']={"border-left-color":this.options.annotationColors.spacing["line:hover"]},this.canvasStyles[h+':hover ~ [data-xraye-element="'+a+'"][data-xraye-annotation-type] span']={animation:"xraye-attention 0.3s linear 1"},this.canvasStyles[h+':hover ~ [data-xraye-element="'+a+'"][data-xraye-annotation-type="sizing"] span']={color:this.options.annotationColors.sizing["text:hover"],background:this.options.annotationColors.sizing["box:hover"]},this.canvasStyles[h+':hover ~ [data-xraye-element="'+a+'"][data-xraye-annotation-type="spacing"] span']={color:this.options.annotationColors.spacing["text:hover"],background:this.options.annotationColors.spacing["box:hover"]},this.canvasStyles[h+':hover ~ [data-xraye-element="'+a+'"][data-xraye-annotation-type="fontSizing"] span']={color:this.options.annotationColors.fontSizing["text:hover"],background:this.options.annotationColors.fontSizing["box:hover"]},this.renderElement(t("<div "+r+" "+p+" "+l+" />"))},renderElement:function(t,a){if(a||(a=this.$canvas),t instanceof Array)for(var n in t)a.append(t[n]);else a.append(t)},updateStyles:function(t){this.$styles.html(t)},updateCanvasStyles:function(t){this.$canvasStyles.html(t)},getRandomColor:function(){return"#"+(~~(Math.random()*(1<<24))).toString(16)},getRandomId:function(t,a){return t||(t=""),a||(a=""),t+Math.floor(1e5*Math.random())+a},processElements:function(n,e){var o=this;void 0===this.levelColors[e]&&(this.levelColors[e]=this.getRandomColor()),t.each(n,function(){var n=t(this);if(o.isExcluded(n))return!0;var i=o.getElementData(n);if(i.width>=o.options.valueAnnotationThreshold&&i.height>=o.options.valueAnnotationThreshold){var s=o.getRandomId();if(o.options.showSpacing||o.options.showFontSizing){var r=a.getComputedStyle(this,null),l={};if(o.options.showSpacing)for(var p in o.annotationPropertyMapping.spacing)r[o.annotationPropertyMapping.spacing[p]]&&(l[o.annotationPropertyMapping.spacing[p]]=parseInt(r[o.annotationPropertyMapping.spacing[p]],10));o.options.showFontSizing&&(l.fontSize=parseInt(r.fontSize,10))}o.drawElementMask(s,e,i.left-o.elementData.left,i.top-o.elementData.top,i.width,i.height),o.options.showSizing&&(o.drawArrow(s,"width",!0,i.left-o.elementData.left,i.top-o.elementData.top,i.width),o.drawArrow(s,"height",!1,i.left-o.elementData.left,i.top-o.elementData.top,i.height)),o.options.showSpacing&&(l.marginTop>=o.options.valueAnnotationThreshold&&o.drawArrow(s,"marginTop",!1,i.left-o.elementData.left,i.top-o.elementData.top-l.marginTop,l.marginTop),l.marginBottom>=o.options.valueAnnotationThreshold&&o.drawArrow(s,"marginBottom",!1,i.left-o.elementData.left,i.top-o.elementData.top+i.height,l.marginBottom),l.marginLeft>=o.options.valueAnnotationThreshold&&o.drawArrow(s,"marginLeft",!0,i.left-o.elementData.left,i.top-o.elementData.top-l.marginLeft,l.marginLeft),l.marginRight>=o.options.valueAnnotationThreshold&&o.drawArrow(s,"marginRight",!0,i.left-o.elementData.left+(i.width-l.marginRight),i.top-o.elementData.top+l.marginRight,l.marginRight),l.paddingTop>=o.options.valueAnnotationThreshold&&o.drawArrow(s,"paddingTop",!1,i.left-o.elementData.left,i.top-o.elementData.top,l.paddingTop),l.paddingBottom>=o.options.valueAnnotationThreshold&&o.drawArrow(s,"paddingBottom",!1,i.left-o.elementData.left,i.top-o.elementData.top+(i.height-l.paddingBottom),l.paddingBottom),l.paddingLeft>=o.options.valueAnnotationThreshold&&o.drawArrow(s,"paddingLeft",!0,i.left-o.elementData.left,i.top-o.elementData.top,l.paddingLeft),l.paddingRight>=o.options.valueAnnotationThreshold&&o.drawArrow(s,"paddingRight",!0,i.left-o.elementData.left+(i.width-l.paddingRight),i.top-o.elementData.top,l.paddingRight)),o.options.showFontSizing&&l.fontSize&&l.fontSize>0&&t.trim(n.contents().filter(function(){return 3==this.nodeType||"P"===this.tagName}).text()).length>0&&o.drawTextBox(s,"fontSize",i.left-o.elementData.left+i.width+1,i.top-o.elementData.top+1,l.fontSize)}if(!o.isExcludedChildren(n)){var h=n.children();h.length>0&&o.processElements(h,e+1)}})},getElementData:function(t){var a=t.offset();return{left:Math.floor(a.left),top:Math.floor(a.top),width:Math.floor(t.outerWidth()),height:Math.floor(t.outerHeight())}}},t.fn.xraye=function(a){return this.each(function(){t.data(this,"plugin_xraye")||t.data(this,"plugin_xraye",new i(this,a))})}}(jQuery,window,document);